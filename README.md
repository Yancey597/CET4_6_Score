# CET_Score
![Language](https://img.shields.io/badge/language-python-brightgreen)  

本项目用于根据已有的 Excel 报名信息，批量查询英语四六级成绩，在成功获取成绩后，将分数保存至本地。如果本项目对您有所帮助，欢迎 star！谢谢

## 更新日志

- 2024-02-27: 初始版本
- 2024-08-28: version 2.0
  -- 修改保存为 CSV 时可能出现的中文乱码问题
  -- 增加全局配置，导出自定义
  -- 导出结果默认删除身份证与准考证号
- 2024-08-28: version 3.0
  -- 新语法大幅优化代码逻辑，提高运行速度

## 使用方法

1. 将包含考生姓名和身份证号的表格（data.xlsx）与本程序放在同一目录下
2. 根据需要调整全局配置，填写 cookie ，运行程序
3. 程序会自动查询所有考生的成绩（优先查找本次六级成绩，没有的话查找对应的四级成绩，都没有则输出未参加，对应 grade.csv 文件的考试等级列）
4. 导出至 `grade.csv` 文件中

## 注意

- 需要安装 `requests` 和 `pandas` 库。

- Header: 
  - 需要添加请求头，没有 cookie，大概率报 403
  
  - 获取 cookie 请前往官网 https://cjcx.neea.edu.cn/html1/folder/21083/9970-1.htm
  
    - F12 进入开发者工具
  
      ![Clip_2024-08-23_16-55-21](https://gitee.com/yancey597/img-load/raw/master/images/Clip_2024-08-23_16-55-21.png)
  
- 四六级成绩查询 api : "http://cachecloud.neea.cn/api/latest/results/cet"
  - 可能不固定，根据情况调整
  
- 需要提前准备的`data.xlsx` 文件的格式如下：

```
姓名 | 身份证号
------- | --------
张三 | 123456789012345678
李四 | 123456789012345679
```

- `grade.csv` 文件的格式如下：

```
姓名 | 身份证号 | 准考证号 | 考试等级 | 成绩 | 听力部分 | 阅读部分 | 写作部分
------- | -------- | -------- | -------- | -------- | -------- | -------- | --------
李健 | 123456789012345678 | 1234567890 | CET4 | 550 | 120 | 200 | 230
肖洋 | 123456789012345679 | 1234567891 | CET6 | 425 | 100 | 175 | 150
李子轩 | 123456789012345679 | 1234567891 | 未参加 |  |  |  | 
```

## 联系方式

- 作者：Yancey

- god@yancey.vip

  

## 免责声明

本项目仅作为交流学习使用，通过本项目加深网络通信、接口编写、交互设计等方面知识的理解，请勿用作商业用途，任何人或组织使用项目中代码进行的任何违法行为与本人无关。

## 开源协议

![License](https://img.shields.io/badge/license-MIT-yellow) 

本项目采用 MIT 开源协议，欢迎自由使用和修改。

## 参考文档
https://blog.csdn.net/sixibiheye/article/details/123111076
